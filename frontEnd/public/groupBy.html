

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Item Search</title>
    <script type="module">
        import { loadHTMLWithScriptAndCallback } from "./HTMLLoader.js";
        import { updateNavbarDisplay } from './navbar.js'; 
        // Call loadHTMLWithScript function to include navbar.html, load navbar.js and update display
        loadHTMLWithScriptAndCallback("navbar.html", "navbar", "navbar.js", updateNavbarDisplay);    
      </script>      
</head>
<body>
    <div id="navbar"></div>

    <h1>Search Items</h1>
    
    <!-- Dropdown for group by option -->
    <select id="groupByOption">
        <option value="name">Name</option>
        <option value="madeIn">Made In</option>
        <option value="color">Color</option>
        <option value="distributor">Distributor</option>
        <option value="quality">Quality</option>
    </select>

    <!-- Search button -->
    <button id="searchButton" class="search-button">Search</button>

    <div id="itemList">
        <!-- Item list will be dynamically populated here -->
    </div>

    <script>
        // Function to include HTML file

   
        // Function to display items based on search query and group by option
        function displayItems(items) {
            const itemList = document.getElementById('itemList');
            itemList.innerHTML = '';

            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.classList.add('item');
                itemDiv.textContent = `${item._id} - Number of Items: ${item.totalItems}`;
                itemList.appendChild(itemDiv);
            });

            if (items.length === 0) {
                const noResults = document.createElement('div');
                noResults.textContent = 'No items found.';
                itemList.appendChild(noResults);
            }
        }

        // Event listener for search button click
        document.getElementById('searchButton').addEventListener('click', function() {
            const groupByOption = document.getElementById('groupByOption').value;
            fetchItems(groupByOption);
        });

        async function fetchItems(groupByOption) {
            try {
                const response = await fetch(`http://localhost:3000/items/group-by-dynamic?groupBy=${groupByOption}`);
                const items = await response.json();
                console.log(items);
                displayItems(items);
                // renderGraphs(items);  // You can call renderGraphs if needed
            } catch (error) {
                console.error('Error fetching items:', error);
            }
        }
    </script>
</body>
</html>
